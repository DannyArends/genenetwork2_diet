// Generated by CoffeeScript 1.3.3
(function() {

  $(function() {
    var populate_datasets, populate_groups, populate_species, populate_types, process_json, redo_dropdown,
      _this = this;
    process_json = function(data) {
      window.jdata = data;
      return populate_species();
    };
    $.ajax('/static/new/javascript/dataset_menu_structure', {
      dataType: 'json',
      success: process_json
    });
    populate_species = function() {
      var species_list;
      species_list = this.jdata.species;
      redo_dropdown($('#species'), species_list);
      return populate_groups();
    };
    populate_groups = function() {
      var group_list, species;
      species = $('#species').val();
      group_list = this.jdata.groups[species];
      redo_dropdown($('#group'), group_list);
      return populate_types();
    };
    populate_types = function() {
      var group, species, type_list;
      species = $('#species').val();
      group = $('#group').val();
      type_list = this.jdata.types[species][group];
      redo_dropdown($('#type'), type_list);
      return populate_datasets();
    };
    populate_datasets = function() {
      var dataset_list, group, species, type;
      species = $('#species').val();
      group = $('#group').val();
      type = $('#type').val();
      dataset_list = this.jdata.datasets[species][group][type];
      return redo_dropdown($('#dataset'), dataset_list);
    };
    redo_dropdown = function(dropdown, items) {
      var item, _i, _len, _results;
      dropdown.empty();
      _results = [];
      for (_i = 0, _len = items.length; _i < _len; _i++) {
        item = items[_i];
        _results.push(dropdown.append($("<option />").val(item[0]).text(item[1])));
      }
      return _results;
    };
    $('#species').change(function() {
      return populate_groups();
    });
    $('#group').change(function() {
      return populate_types();
    });
    return $('#type').change(function() {
      return populate_datasets();
    });
  });

}).call(this);
