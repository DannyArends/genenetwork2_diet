// Generated by CoffeeScript 1.4.0
(function() {

  $(function() {
    var composite_mapping_fields, get_progress, submit_special, toggle_enable_disable,
      _this = this;
    submit_special = function() {
      var url;
      console.log("In submit_special");
      console.log("this is:", this);
      console.log("$(this) is:", $(this));
      url = $(this).data("url");
      console.log("url is:", url);
      $("#trait_data_form").attr("action", url);
      return $("#trait_data_form").submit();
    };
    get_progress = function() {
      var params, params_str, temp_uuid, url,
        _this = this;
      console.log("temp_uuid:", $("#temp_uuid").val());
      temp_uuid = $("#temp_uuid").val();
      params = {
        key: temp_uuid
      };
      params_str = $.param(params);
      url = "/get_temp_data?" + params_str;
      console.log("url:", url);
      $.ajax({
        type: "GET",
        url: url,
        success: function(progress_data) {
          console.log("in get_progress data:", progress_data);
          console.log(progress_data['percent_complete'] + "%");
          return $('#marker_regression_progress').css("width", progress_data['percent_complete'] + "%");
        }
      });
      return false;
    };
    $("#marker_regression").click(function() {
      var form_data, url;
      $("#progress_bar_container").modal();
      url = "/marker_regression";
      form_data = $('#trait_data_form').serialize();
      console.log("form_data is:", form_data);
      $.ajax({
        type: "POST",
        url: url,
        data: form_data,
        error: function(xhr, ajaxOptions, thrownError) {
          alert("some error occurred");
          console.log(xhr);
          clearInterval(_this.my_timer);
          $('#progress_bar_container').modal('hide');
          return $("body").html("error");
        },
        success: function(data) {
          clearInterval(_this.my_timer);
          $('#progress_bar_container').modal('hide');
          return $("body").html(data);
        }
      });
      console.log("settingInterval");
      _this.my_timer = setInterval(get_progress, 1000);
      return false;
    });
    composite_mapping_fields = function() {
      return $(".composite_fields").toggle();
    };
    $("#use_composite_choice").change(composite_mapping_fields);
    toggle_enable_disable = function(elem) {
      return $(elem).prop("disabled", !$(elem).prop("disabled"));
    };
    $("#choose_closet_control").change(function() {
      return toggle_enable_disable("#control_locus");
    });
    return $("#display_all_lrs").change(function() {
      return toggle_enable_disable("#suggestive_lrs");
    });
  });

}).call(this);
